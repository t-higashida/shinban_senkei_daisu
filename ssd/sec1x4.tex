\section{1次写像}

ふつうの平面の1次変換は，平面上の点集合から点集合への写像$(x,y) \rightarrow (x', y')$で，
\[
	\begin{cases}
		\: x' = ax + by \\
    \: y' = cx + dy
	\end{cases}
  \text{$a,b,c,d$は実数の定数}
\]
を満たすものであった．この平面の1次変換の概念を一般化しよう．

\定義{}
$n,m$は必ずしも等しくない自然数とする．
$K^n$から$K^m$への写像$\displaystyle \begin{bmatrix}
		             x_1 \\ x_2 \\ \vdots \\ x_n
							 \end{bmatrix}
               \rightarrow
               \begin{bmatrix}
		             x_1' \\ x_2' \\ \vdots \\ x_m'
							 \end{bmatrix}
$が
\[
	\begin{cases}
		\: x_1' = a_{11}x_1 + a_{12} x_2 + \cdots + a_{1n} x_n \\
		\: x_2' = a_{21}x_1 + a_{22} x_2 + \cdots + a_{2n} x_n \\
    \: \cdots \cdots \\
		\: x_m' = a_{m1}x_1 + a_{m2} x_2 + \cdots + a_{mn} x_n
	\end{cases}
  \quad \text{($a_{ij}$はすべて定数で，$K$の要素)}
\]
を満たすとき，
\footnote
{
 各$x_i' \: (i=1, 2 , \cdots , m)$が$x_1 , x_2 , \cdots , x_n$の
同次1次式(定数項のない1次式)であることが特徴である．
}
この写像を，$K^n$から$K^m$への\textbf{1次写像}または\textbf{線形写像}
という．とくに，$K^n$から$K^n$への1次写像を，$K^n$の\textbf{1次変換}という．

\例{4.1}

（保留）

上の1次写像を与える式は，
\[
	\begin{bmatrix}
		x_1' \\
		x_2' \\
    \vdots \\
		x_m'    
	\end{bmatrix}
  =
	\begin{bmatrix}
		a_{11} & a_{12} & \cdots & a_{1n} \\
		a_{21} & a_{22} & \cdots & a_{2n} \\
    \vdots & \vdots &        & \vdots \\
		a_{m1} & a_{m2} & \cdots & a_{mn}
	\end{bmatrix}
	\begin{bmatrix}
		x_1 \\ x_2 \\ \vdots \\ x_n
	\end{bmatrix}
\]
と表せる．したがって，$K^n$から$K^m$への1次写像
$\displaystyle \begin{bmatrix}
		             x_1 \\ x_2 \\ \vdots \\ x_n
							 \end{bmatrix}
               \rightarrow
               \begin{bmatrix}
		             x_1' \\ x_2' \\ \vdots \\ x_m'
							 \end{bmatrix}
$は，$K$の上の$(m,n)$行列$A = [ a_{ij} ]$で与えられる写像
$\displaystyle \begin{bmatrix}
		             x_1 \\ x_2 \\ \vdots \\ x_n
							 \end{bmatrix}
               \rightarrow
               A
               \begin{bmatrix}
		             x_1 \\ x_2 \\ \vdots \\ x_n
							 \end{bmatrix}
$にほかならない．

この1次写像を記号$L_A$と表して，
\textbf{行列$A$が定める1次写像}($m=n$のときには，\textbf{行列$A$が定める1次変換})という．
このとき，$\boldsymbol{x} \in K^n$に対して，
$L_a (\boldsymbol{x} = A \boldsymbol{x}$となる．

1次写像$L_A : K^n \rightarrow K^m$について，次の基本性質が成り立つ．
\begin{list}{}{}
	\item	(ⅰ) $\boldsymbol{x}, \boldsymbol{y} \in K^n$に対して，$L_A (\boldsymbol{x} + L_A (\boldsymbol{y})$
	\item	(ⅱ) $\boldsymbol{x} \in K^n, \alpha \in K$に対して，$L_A (\alpha \boldsymbol{x}) = \alpha L_A (\boldsymbol{x})$ 
\end{list}
これはは行列の演算の性質$A (\boldsymbol{x} + \boldsymbol{y} = A \boldsymbol{x} + A \boldsymbol{y}
, A(\alpha \boldsymbol{x}) = \alpha (A \boldsymbol{x})$より明らかである．

上の事柄の逆が成り立つことを示そう．そのために，まず次の命題を証明しよう．

\命題{1.4.1}

写像$F: K^n \rightarrow K^m$が
\begin{list}{}{}
	\item	(ⅰ) $\boldsymbol{x} , \boldsymbol{y} \in K^n$に対して，
$F(\boldsymbol{x} + \boldsymbol{y}) = F(\boldsymbol{x}) + F(\boldsymbol{y})$ 
	\item (ⅱ) $\boldsymbol{x} \in K^n, \alpha \in K$に対して，
$F(\alpha \boldsymbol{x}) = \alpha F(\boldsymbol{x})$
\end{list}
をみたすならば，写像$F$について，次のことが成り立つ．
\begin{list}{}{}
	\item	(1) $F(\boldsymbol{0}_n) = \boldsymbol{0}_m$
	\item (2) $\boldsymbol{x} \in K^n$に対して，$F(-\boldsymbol{x}) = - F(\boldsymbol{x})$
	\item (3) $\boldsymbol{x} , \boldsymbol{y} \in K^n$に対して，
$F(\boldsymbol{x} - \boldsymbol{y}) = F(\boldsymbol{x}) - F(\boldsymbol{y})$
	\item (4) $\boldsymbol{x}_1 , \boldsymbol{x}_2, \cdots , \boldsymbol{x}_s \in K^n$に対して，
$F(\boldsymbol{x}_1+\boldsymbol{x}_2) + \cdots + \boldsymbol{x}_s)
 =
F(\boldsymbol{x}_1) + F(\boldsymbol{x}_2 +  \cdots + F(\boldsymbol{x}_s)$
	\item (5) $\boldsymbol{x}_1 , \boldsymbol{x}_2, \cdots , \boldsymbol{x}_s \in K^n$および
$\alpha_1, \alpha_2 , \cdots , \alpha_s \in K$に対して，
\[
	F (\alpha_1 \boldsymbol{x}_1 + \alpha_2 \boldsymbol{x}_2 + \cdots + \alpha_s \boldsymbol{x}_s)
  =
  \alpha_1 F(\boldsymbol{x}_1) + \alpha_2 F(\boldsymbol{x}_2) \cdots + \alpha_sF(\boldsymbol{x}_s)
\]
\end{list}

\証明

(1) $\boldsymbol{x} \in K^n$を任意にとって，$\alpha = 0$のときの（ⅱ）から，
$F(0 \boldsymbol{x}) = 0 F(\boldsymbol{x})$を得る．したがって，$F(\boldsymbol{0_n})=\boldsymbol{0}_m$.

(2) $\alpha = -1 $のときの（ⅱ）から，$F((-1) \boldsymbol{x} ) = (-1) F(\boldsymbol{x})$．したがって，
$F(-\boldsymbol{x})=-F(\boldsymbol{x})$を得る．

(3) (ⅰ),(2)を用いて，
\[
	F(\boldsymbol{x} - \boldsymbol{y}) = F(\boldsymbol{x} + (-\boldsymbol{y})) 
= F(\boldsymbol{x}) + F(-\boldsymbol{y})
= F(\boldsymbol{x}) - F(\boldsymbol{y})
\]

(4) (ⅰ)を繰り返し用いて，
\begin{align*}
	F(\boldsymbol{x}_1+\boldsymbol{x}_2 + \cdots + \boldsymbol{x}_s)
  &=
  F(\boldsymbol{x}_1) + F(\boldsymbol{x}_1+\boldsymbol{x}_2 + \cdots + \boldsymbol{x}_s) \\
  &= \cdots \\
  &=
  F(\boldsymbol{x}_1) + F(\boldsymbol{x}_2) +  \cdots + F(\boldsymbol{x}_s) \\
\end{align*}

(5)（4)，(ⅱ)を用いて，
\begin{align*}
	F (\alpha_1 \boldsymbol{x}_1 + \alpha_2 \boldsymbol{x}_2 + \cdots + \alpha_s \boldsymbol{x}_s)
  &= 
	F (\alpha_1 \boldsymbol{x}_1) + F(\alpha_2 \boldsymbol{x}_2) + \cdots + F(\alpha_s \boldsymbol{x}_s) \\
  &= \cdots \\
  &=
  \alpha_1 F(\boldsymbol{x}_1) + \alpha_2 F(\boldsymbol{x}_2) \cdots + \alpha_sF(\boldsymbol{x}_s)
\end{align*}
\■

\定理{1.4.2}
写像$F : K^n \rightarrow K^m$が，命題1.4.1の条件(ⅰ),(ⅱ)をみたすならば，
$F = L_A$となる$(m,n)$行列$A$がただ1つ存在する．したがって，$F$は1次写像である．

\証明
ベクトル$\displaystyle \boldsymbol{x} = \begin{bmatrix}
		                                      x_1 \\ x_2 \\ \vdots \\ x_n 
																				\end{bmatrix} \in K^n$は，
$n$項基本ベクトル$\boldsymbol{e}_1 , \boldsymbol{e}_2 , \cdots , \boldsymbol{e}_n$の
1次結合として，
\[
	\boldsymbol{x} = x_1 \boldsymbol{e}_1 + x_2 \boldsymbol{e}_2 + \cdots + x_n \boldsymbol{e}_n
\]
と表せる．両辺を$F$で移すと，命題1.4.1の(5)より
\begin{align*}
	F(\boldsymbol{x}) &= x_1 F(\boldsymbol{e}_1) + x_2 F(\boldsymbol{e}_2)+ \cdots + x_n F(\boldsymbol{e}_n) \\
                    &= \begin{bmatrix}
		                      F(\boldsymbol{e}_1) & F(\boldsymbol{e}_2) & \cdots & F(\boldsymbol{e}_n)
											 \end{bmatrix}
                       \begin{bmatrix}
                          x_1 \\ x_2 \\ \vdots \\ x_n
											 \end{bmatrix}
\end{align*}
各$F(\boldsymbol{e}_j)$は$m$項数ベクトルであるから，
行列$\begin{bmatrix} F(\boldsymbol{e}_1) & F(\boldsymbol{e}_2) & \cdots & F(\boldsymbol{e}_n) \end{bmatrix}$
は$(m,n)$行列である．この行列を$A$とおくと，$F(\boldsymbol{x}=A \boldsymbol{x}$．
これは，$F$は1次写像$L_A$に等しいことを意味する．$A$とは別に$(m,n)$行列$B$があって，
$F=L_B$となったとしても，$F(\boldsymbol{e}_j = L_B (\boldsymbol{e}_j) = B \boldsymbol{e}_j$となり，
$B \boldsymbol{e}_j$は行列$B$の第$j$列であるから，$A$の第$j$列と$B$の第$j$列は等しい．
これが各$j$についていえるから，$A=B$である．ゆえに$F=L_A$となる行列$A$はただ1つである．
\■

上の定理によって，1次写像$F : K^n \rightarrow K^m$は，条件
\begin{list}{}{}
	\item	(ⅰ) $\boldsymbol{x} , \boldsymbol{y} \in K^n$に対して，$F(\boldsymbol{x} + \boldsymbol{y}) = F(\boldsymbol{x}) + F(\boldsymbol{y})$
	\item (ⅱ) $\boldsymbol{x} \in K^n, \alpha \in K$に対して，$F ( \alpha \boldsymbol{x}) = \alpha F(\boldsymbol{x})$
\end{list}
を満たす写像$F : K^n \rightarrow K^m$であることがわかった．とくに，
$m=n$として，次のことがわかる．

\系{1.4.3}
$K^n$から$K^n$自身への写像$F$が，条件
\begin{list}{}{}
	\item	(ⅰ) $\boldsymbol{x},\boldsymbol{y} \in K^n$に対して，$F(\boldsymbol{x} + \boldsymbol{y}) = F(\boldsymbol{x})  + F(\boldsymbol{y})$
	\item	(ⅱ) $\boldsymbol{x} \in K^n, \alpha \in K$に対して，$F(\alpha \boldsymbol{x}) = \alpha F(\boldsymbol{x})$ 
\end{list}
をみたすならば，$F$は$K^n$の1次変換で，$K$の上の$n$次行列$A$がただ1つ存在して，$F=L_A$となる．